### 文件系统

Unix将存储在磁盘中的数据组织成文件系统。文件系统是文件和目录的集合。**目录是名字和指针的列表。目录中的每一个入口指向一个文件或目录。目录包含指向父目录和子目录的入口。**

Unix文件系统包含3个主要部分：超级块、i-节点表和数据区域。文件内容存储在数据块。文件属性存储在i-节点。表中i-节点的位置称为文件的i-节点号。i-节点号是文件的唯一标识。

**相同的i-节点号可能以不同的名字在若干个目录中出现。每个入口被称为指向文件的硬链接。符合链接是通过文件名引用文件，而不是i-节点号。**

若干个文件系统的目录树可被整合成一颗树。内核将一个文件系统的目录链接到另一个文件系统的根的操作称为装载。

”文件在某个目录中“，从系统角度看就是目录中有一个包含文件名y和i-节点号为491的入口。

cat的工作流程：

cat userlist

1）在目录中寻找文件名

​	文件名存储在目录文件中。内核在目录文件中寻找包含字符串userlist的纪录。userlist所在的纪录包含编号为47的i-节点号。

2）定位i-节点47并读取其内容

​	内核在文件系统中的i-节点区域找到i-节点47。定位一个i-节点可能需要一些简单的计算，所有的i-节点大小相同，每个磁盘块都包含相同数量的i-节点。为了提高访问效率，内核有可能将i-节点置于缓冲区中。i-节点包含数据块编号的列表。

3）访问存储文件内容的数据块

​	通过以上过程，内核已经可以知道文件内容存放在哪些数据块上，以及它们的顺序。由于cat不断地调用read函数，使得内核不断将字节从磁盘复制到内核缓冲区，进而到达用户空间。

